{% if use_theme_basic_template|default(true) %}
{%- extends config.BASE_TEMPLATE %}
{% endif %}

{%- set title = record.metadata.title -%}
{%- set metadata = record.metadata %}

{%- macro accessRightsIcon(accessRights) -%}
{%- if accessRights == "otevřený přístup" -%}
/static/icons/locks/zamky_open_access.svg
{%- elif accessRights == "omezený přístup" -%}
/static/icons/locks/zamky_Partialy_closed_access.svg
{%- else -%}
/static/icons/locks/zamky_Closed_access.svg
{%- endif -%}
{%- endmacro -%}

{%- macro accessRightsFile(file_type, accessRights, classes) -%}
<div style="position: relative;">
    <img style="display: block; width: 100%; height: auto; padding-bottom: 8px;"
         src="/static/icons/files/{{file_type}}.svg"
         title="typ přístupu"
    />
    <img class="ui mini image" style="position: absolute; bottom: 0; right: 0; margin-right: 2px;"
         src="{{accessRightsIcon(accessRights)}}"
         title="typ přístupu"
    />
</div>
{%- endmacro -%}

{%- macro accessRightsText(accessRights) -%}
{%- if accessRights == "otevřený přístup" -%}
Hlavní text práce<!-- volně dostupný -->
{%- elif accessRights == "omezený přístup" -%}
Hlavní text práce<!-- s omezeným přístupem -->
{%- else -%}
Hlavní text práce<!-- nedostupný -->
{%- endif -%}
{%- endmacro -%}


{% macro langtag(lang) -%}
<div class="ui basic green reduced label">{{lang}}</div>
{%- endmacro %}

{% macro vertbar() %}
<div style="border-left: 2px solid lightgreen; margin-left: .2em; margin-right: .1em; display: inline-block; line-height: 100%">
    &nbsp;
</div>
{% endmacro %}

{% macro double_vertbar() %}
<div style="width: 1px; overflow-x: clip; border-left: 2px solid lightgreen; margin:0; display: inline-block; line-height: 90%">
    &nbsp;
</div>
<div style="width: 1px; overflow-x: clip; border-left: 2px solid lightgreen; margin:0; display: inline-block; line-height: 90%">
    &nbsp;
</div>
{% endmacro %}

{% macro systemIdentifier(si) %}
<div style="display: flex; align-items: center">
    <div class="ui basic blue reduced label">{{ si.scheme }}</div>
    <div style="margin-left: .5em; white-space: nowrap">
        {% if si.identifier.startswith('http://') or si.identifier.startswith('https://') %}
        <a href="{{si.identifier}}">{{si.identifier}}</a>
        {% else %}
        {{ si.identifier }}
        {% endif %}
    </div>
</div>
{% endmacro %}


{%- block page_body %}

<div class="ui container record-page">
    <div class="ui relaxed grid mt-5">
        <div class="row top-padded">

            {# Main content #}
            <article class="wide column main-record-content">
                {%- block record_body -%}


                {%- block record_header -%}
                <div class="ui grid stackable">
                    <div class="ui column">
                        <a href="/search">   <!-- TODO: url with filters, page etc -->
                            <i class="icon arrow left"></i>
                            <span>Zpět na výsledky vyhledávání</span>
                        </a>
                    </div>
                </div>
                {%- endblock record_header -%}


                {# Title #}
                {%- block record_title -%}
                <div class="ui header">
                    <section id="record-title-section" aria-label="{{ _('Record title') }}">
                        <h1 class="title">
                            <div style="display: flex; align-items: start; column-gap: 5px;">
                                <!--                                <img class="ui avatar image"-->
                                <!--                                     src="{{accessRightsIcon(metadata.accessRights)}}"-->
                                <!--                                     title="otevřený přístup"-->
                                <!--                                />-->
                                <div>
                                    {{metadata.title}}
                                </div>
                            </div>
                        </h1>
                    </section>
                    <div class="ui hidden divider"></div>
                </div>


                {%- endblock record_title -%}
                <div class="ui grid">
                    {# hlavni blok #}
                    <div class="ui eleven wide column">
                        <div class="ui inverted vertical transparent section">
                            {% for title in metadata.additionalTitles %}
                            <div class="display-row">
                                <label class="ui bolder label">{{title.titleType}}: </label>
                                <div>
                                    {{ langtag(title.title.0.lang) }}
                                    <span>
                                        {{ title.title.0.value }}
                                    </span>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                        <div class="ui inverted vertical transparent section">
                            <div class="display-row">
                                <label class="ui bolder label">Osoby: </label>
                                <div>
                                    {% for person in metadata.creators %}
                                    {% if loop.index0 %} {{ vertbar() }} {% endif %}
                                    {{ person.fullName }}
                                    {% endfor %}
                                    {% if metadata.contributors %} {{ double_vertbar() }}{%endif%}
                                    {% for person in metadata.contributors %}
                                    {% if loop.index0 %} {{ vertbar() }} {% endif %}
                                    {{ person.fullName }} ({{person.role}})
                                    {% endfor %}
                                </div>
                            </div>
                        </div>
                        <div class="ui inverted vertical transparent section">
                            <div class="display-row">
                                <label class="ui bolder label">Datum: </label>
                                <div>
                                    {% if metadata.dateIssued %}
                                    {{ (metadata.dateIssued or '')[:4] }}
                                    {% endif %}
                                    {% if metadata.dateModified and metadata.dateIssued and (metadata.dateIssued or '')[:4] != (metadata.dateModified or '')[:4] %}
                                    {{ double_vertbar() }}
                                    {% endif %}
                                    {% if (metadata.dateIssued or '')[:4] != (metadata.dateModified or '')[:4] %}
                                    {{ (metadata.dateModified or '')[:4] }} (upraveno)
                                    {% endif %}
                                    {% if metadata.dateDefended and (metadata.dateIssued or '')[:4] != (metadata.dateModified or '')[:4] %}
                                    {{ double_vertbar() }}
                                    {{ (metadata.dateDefended or '') }} (datum obhajoby)
                                    {% endif %}
                                </div>
                            </div>
                        </div>

                        <div class="ui inverted vertical transparent section">
                            <div class="display-row">
                                <label class="ui bolder label">Jazyk: </label>
                                <div>
                                    {% for lang in metadata.languages %}
                                    {% if loop.index0 %} {{ vertbar() }} {% endif %}
                                    {{lang}}
                                    {% endfor %}
                                </div>
                            </div>
                        </div>

                        <div class="ui inverted vertical transparent section">
                            <div class="display-row">
                                <label class="ui bolder label">Typ dokumentu: </label>
                                <div>
                                    {{metadata.resourceType}}
                                    {% if metadata.defended %}
                                    <span style="color: green">&nbsp;(obhájeno) </span>
                                    {% elif metadata.defended is false %}
                                    <span style="color: darkred">&nbsp;(neobhájeno) </span>
                                    {% endif %}
                                    {% if metadata.extent %}
                                    {{ double_vertbar() }}
                                    {{ metadata.extent }}
                                    {% endif %}
                                </div>
                            </div>
                        </div>

                        <!-- todo: identifikator dila, doi, vydavatel, edice -->
                        <div class="ui inverted vertical transparent section">
                            <div class="display-row">
                                <label class="ui bolder label">Klíčová slova: </label>
                                <!-- TODO: by language, ne jenom cs a en; bude to chtit preprocessing -->
                                <div>
                                    <div>
                                        {{ langtag("cs") }}
                                        {% for subject in metadata.subjects %}
                                        {% for s in subject.subject %}
                                        {% if s.lang == 'cs' %}
                                        <span class="if-not-second">{{ vertbar() }}</span>
                                        <span>{{s.value}}</span>
                                        {% endif %}
                                        {% endfor %}
                                        {% endfor %}
                                    </div>
                                    <div>
                                        {{ langtag("en") }}
                                        {% for subject in metadata.subjects %}
                                        {% for s in subject.subject %}
                                        {% if s.lang == 'en' %}
                                        <span class="if-not-second">{{ vertbar() }}</span>
                                        <span>{{s.value}}</span>
                                        {% endif %}
                                        {% endfor %}
                                        {% endfor %}
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="ui inverted vertical transparent section">
                            <div class="display-row">
                                <label class="ui bolder label">Abstrakt: </label>
                                <div>
                                    <div class="ui tabular nr menu">
                                        <div class="item active" data-tab="abstract-cs">
                                            <div>cs</div>
                                        </div>
                                        <div class="item" data-tab="abstract-en">
                                            <div>en</div>
                                        </div>
                                    </div>
                                    {% for a in metadata.abstract %}
                                    <div class="ui tab {% if a.lang == 'cs'%}active{%endif%}"
                                         data-tab="abstract-{{a.lang}}">
                                        {{a.value}}
                                    </div>
                                    {%endfor%}
                                </div>
                            </div>
                        </div>
                        <!-- todo: poznamka, akce, je soucasti, projekt -->
                        <div class="ui inverted vertical transparent section">
                            <div class="display-row">
                                <label class="ui bolder label">Instituce / grantor: </label>
                                <div>
                                    {% for d in metadata.degreeGrantor %}
                                    {% if loop.index0 %} {{ vertbar() }} {% endif %}
                                    {{d}}
                                    {% endfor %}
                                </div>
                            </div>
                        </div>
                        <!-- todo: poznamka, akce, je soucasti, projekt -->
                        <div class="ui inverted vertical transparent section">
                            <div class="display-row">
                                <label class="ui bolder label">Oblast studia: </label>
                                <div>
                                    {% for d in metadata.studyFields %}
                                    {% if loop.index0 %} {{ vertbar() }} {% endif %}
                                    {{d}}
                                    {% endfor %}
                                </div>
                            </div>
                        </div>
                        <!-- todo: prava -->
                        <div class="ui inverted vertical transparent section">
                            <div class="display-row">
                                <label class="ui bolder label">Dostupnost: </label>
                                <div>
                                    {% for a in metadata.accessibility %}
                                    <div>
                                        {{ langtag(a.lang) }}
                                        <span>
                                            {{ a.value }}
                                        </span>
                                    </div>
                                    {% endfor %}
                                </div>
                            </div>
                        </div>
                        <div class="ui inverted vertical transparent section">
                            <div class="display-row">
                                <label class="ui bolder label">Původní záznam: </label>
                                <a href="{{metadata.originalRecord}}" target="_blank">
                                    {{metadata.originalRecord}}
                                </a>
                            </div>
                        </div>
                    </div>
                    {# spacer #}
                    <div class="ui one wide column"></div>
                    {# levy block #}
                    <div class="ui four wide column">
                        <div class="ui inverted vertical transparent section">
                            <!-- div>
                                Vypada to ze zatim tam zadnou licenci nemame, takze tohle je prazdne

                                <div class="ui fluid">Licence: &nbsp;&nbsp;</div>
                                <img src="/static/images/licenses/by-nc.png" style="width: 50%"/>
                            </div -->
                            <div>
                                <div class="ui fluid bolder label">Kolekce: &nbsp;&nbsp;</div>
                                {{metadata.collection}}
                            </div>
                            <div class="ui hidden divider"></div>

                            <a href="{{metadata.originalRecord}}" target="_blank">
                                <div style="display: flex; align-items: center; margin-left: -20px;" class="wide">
                                    <div style="flex: 1 1 0">
                                        {{accessRightsFile('pdf', metadata.accessRights, "small")}}
                                    </div>
                                    <div style="flex: 1.5 1 0">
                                        {{accessRightsText(metadata.accessRights)}}
                                    </div>
                                </div>
                            </a>
                            <div class="ui divider"></div>
                            <div>
                                <div class="ui fluid bolder label">Systémové identifikátory</div>
                                <div>
                                    {% for si in metadata.systemIdentifiers %}
                                    <div style="margin-top: 1em;">
                                        {{systemIdentifier(si)}}
                                    </div>
                                    {% endfor %}
                                </div>
                            </div>
                            <div class="ui hidden divider"></div>
                            <div>
                                <div class="ui fluid bolder label">Metadata: &nbsp;&nbsp;</div>
                                <a href="{{record.links.self}}" target="_blank">{{record.links.self}}</a>
                            </div>
                        </div>
                    </div>
                </div>
                {%- endblock record_body %}
            </article>

            {# Sidebar #}
            <!-- aside class="sixteen wide tablet five wide computer column sidebar" aria-label="{{ _('Record details') }}">
                {% block record_sidebar %}
                {% endblock record_sidebar %}
            </aside -->
        </div>
    </div>
</div>

{%- endblock page_body %}

{%- block javascript %}
{% if use_theme_basic_template|default(true) %}
{{ super() }}
{% else %}
{% include config.THEME_JAVASCRIPT_TEMPLATE %}
{% endif %}
<script>$('.tabular.menu .item').tab();</script>
{%- endblock javascript %}
